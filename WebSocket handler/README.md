## Инструкция по использованию WebSocket Handler

### Общая информация

WebSocket Handler обеспечивает взаимодействие между клиентами и сервером в режиме реального времени. Он обрабатывает подключение пользователей, отправку и получение сообщений, а также управление чатами. Ниже описаны форматы входящих и исходящих сообщений, которые используются для взаимодействия с WebSocket Handler.

### Пример реализации клиента

Для изучения работы WebSocket Handler и реализации аналогичной логики в вашем интерфейсе, рекомендуется изучить тестовые клиенты:

1. Веб-клиент в браузере:
   - Чтобы подключиться к тестовому клиенту, запустите все необходимые микросервисы, включая WebSocket Handler.
   - Перейдите в браузере по адресу `http://handler_url/`, где `handler_url` — это URL из вашего `config.json`.
   - Изучите код тестового клиента, чтобы понять, как реализовать логику взаимодействия с WebSocket Handler.

2. Тестовый клиент на Tkinter:
   - У нас также есть отдельный тестовый клиент, реализованный на Tkinter, который имитирует пользователя.
   - Этот клиент подключается по WebSocket и позволяет вводить JSON-сообщения для отправки на сервер.
   - Все входящие и исходящие сообщения отображаются в интерфейсе клиента.
   - Изучите код `test_client.py`, чтобы понять, как реализовать взаимодействие с WebSocket Handler в настольных приложениях.

### Формат входящих сообщений

Клиент может отправлять следующие типы сообщений на сервер:

1. Создание чата
   - Тип: `create_chat`
   - Описание: Создает новый чат с указанным пользователем.
   - Формат:
     ```json
     {
         "type": "create_chat",
         "recipient_id": "user2"
     }
     ```
   - Поля:
     - `recipient_id`: Идентификатор пользователя, с которым необходимо создать чат.

2. Отправка сообщения
   - Тип: `send_message`
   - Описание: Отправляет сообщение в указанный чат.
   - Формат:
     ```json
     {
         "type": "send_message",
         "recipient_id": "user2",
         "content": "Привет!",
         "chat_id": "chat123"
     }
     ```
   - Поля:
     - `recipient_id`: Идентификатор получателя сообщения.
     - `content`: Текст сообщения.
     - `chat_id`: Идентификатор чата.

3. Запрос всех чатов и сообщений
   - Тип: `fetch_chats`
   - Описание: Запрашивает все чаты и сообщения пользователя.
   - Формат:
     ```json
     {
         "type": "fetch_chats",
     }
     ```

4. Пинг для поддержания соединения
   - Тип: `ping`
   - Описание: Отправляет пинг-сообщение серверу для проверки соединения.
   - Не нуждается в "token".
   - Формат:
     ```json
     {
         "type": "ping"
     }
     ```

### Формат исходящих сообщений

Сервер отправляет клиенту следующие типы сообщений:

1. Список всех чатов
   - Тип: `all_chats`
   - Описание: Содержит список всех чатов пользователя.
   - Формат:
     ```json
     {
         "type": "all_chats",
         "data": [ /* массив объектов чатов */ ]
     }
     ```

2. Список новых чатов
   - Тип: `new_chats`
   - Описание: Содержит список новых чатов, которые ранее не были доставлены пользователю.
   - Формат:
     ```json
     {
         "type": "new_chats",
         "data": [ /* массив объектов чатов */ ]
     }
     ```

3. Сообщения из чата
   - Тип: `all_messages` или `new_messages`
   - Описание: Содержит сообщения для указанного чата.
   - Формат:
     ```json
     {
         "type": "all_messages",
         "chat_id": "chat123",
         "data": [ /* массив сообщений */ ]
     }
     ```

4. Новое сообщение
   - Тип: `message`
   - Описание: Уведомляет о новом сообщении в реальном времени.
   - Формат:
     ```json
     {
         "type": "message",
         "chat_id": "chat123",
         "sender_id": "user1",
         "content": "Привет!",
         "message_id": "msg456",
         "timestamp": "2023-10-01T12:34:56Z"
     }
     ```

5. Понг-ответ
   - Тип: `pong`
   - Описание: Ответ сервера на пинг-сообщение для подтверждения активности соединения.
   - Формат:
     ```json
     {
         "type": "pong"
     }
     ```
